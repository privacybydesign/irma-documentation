<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1329px" preserveAspectRatio="none" style="width:932px;height:1329px;background:#FFFFFF;" version="1.1" viewBox="0 0 932 1329" width="932px" zoomAndPan="magnify"><defs><filter height="300%" id="f1efaxcpx3muag" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="57" x2="57" y1="88.4883" y2="1244.9785"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="188" x2="188" y1="88.4883" y2="1244.9785"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="279" x2="279" y1="88.4883" y2="1244.9785"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="531.5" x2="531.5" y1="88.4883" y2="1244.9785"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="872.5" x2="872.5" y1="88.4883" y2="1244.9785"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="5" y="85.5352">IRMA app user</text><ellipse cx="57.5" cy="15" filter="url(#f1efaxcpx3muag)" rx="8" ry="8" style="stroke:#7A2626;stroke-width:2.0;fill:none;"/><path d="M57.5,23 L57.5,50 M44.5,31 L70.5,31 M57.5,50 L44.5,65 M57.5,50 L70.5,65 " fill="none" filter="url(#f1efaxcpx3muag)" style="stroke:#7A2626;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="5" y="1257.5137">IRMA app user</text><ellipse cx="57.5" cy="1270.4668" filter="url(#f1efaxcpx3muag)" rx="8" ry="8" style="stroke:#7A2626;stroke-width:2.0;fill:none;"/><path d="M57.5,1278.4668 L57.5,1305.4668 M44.5,1286.4668 L70.5,1286.4668 M57.5,1305.4668 L44.5,1320.4668 M57.5,1305.4668 L70.5,1320.4668 " fill="none" filter="url(#f1efaxcpx3muag)" style="stroke:#7A2626;stroke-width:2.0;"/><rect fill="#004C92" filter="url(#f1efaxcpx3muag)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="79" x="147" y="53"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="154" y="73.5352">IRMA app</text><rect fill="#004C92" filter="url(#f1efaxcpx3muag)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="79" x="147" y="1243.9785"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="154" y="1264.5137">IRMA app</text><rect fill="#004C92" filter="url(#f1efaxcpx3muag)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="74" x="240" y="53"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="247" y="73.5352">frontend</text><rect fill="#004C92" filter="url(#f1efaxcpx3muag)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="74" x="240" y="1243.9785"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="247" y="1264.5137">frontend</text><rect fill="#004C92" filter="url(#f1efaxcpx3muag)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="81" x="489.5" y="53"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="496.5" y="73.5352">requestor</text><rect fill="#004C92" filter="url(#f1efaxcpx3muag)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="81" x="489.5" y="1243.9785"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="496.5" y="1264.5137">requestor</text><rect fill="#004C92" filter="url(#f1efaxcpx3muag)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="95" x="823.5" y="53"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="830.5" y="73.5352">IRMA server</text><rect fill="#004C92" filter="url(#f1efaxcpx3muag)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="95" x="823.5" y="1243.9785"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="830.5" y="1264.5137">IRMA server</text><polygon fill="#A80036" points="267,115.7988,277,119.7988,267,123.7988,271,119.7988" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="57.5" x2="273" y1="119.7988" y2="119.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="64.5" y="115.0566">initiate session</text><polygon fill="#A80036" points="520,145.1094,530,149.1094,520,153.1094,524,149.1094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="526" y1="149.1094" y2="149.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="286" y="144.3672">initiate session</text><polygon fill="#A80036" points="861,174.4199,871,178.4199,861,182.4199,865,178.4199" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532" x2="867" y1="178.4199" y2="178.4199"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35" x="539" y="173.6777">POST</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="578" y="173.6777">/session/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="644" y="173.6777">(create session)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="873" y1="207.7305" y2="207.7305"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="831" y1="207.7305" y2="220.7305"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="872" y1="220.7305" y2="220.7305"/><polygon fill="#A80036" points="864,216.7305,874,220.7305,864,224.7305,868,220.7305" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="723" y="202.9883">set state to INITIALIZED</text><polygon fill="#A80036" points="543,246.041,533,250.041,543,254.041,539,250.041" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="537" x2="872" y1="250.041" y2="250.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="317" x="549" y="245.2988">session pointer + requestor token + frontendAuth</text><polygon fill="#A80036" points="290,275.3516,280,279.3516,290,283.3516,286,279.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="531" y1="279.3516" y2="279.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="296" y="274.6094">session pointer (QR) + frontendAuth</text><polygon fill="#A80036" points="861,304.6621,871,308.6621,861,312.6621,865,308.6621" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="867" y1="308.6621" y2="308.6621"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35" x="286" y="303.9199">POST</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295" x="325" y="303.9199">/irma/session/{clientToken}/frontend/options</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="624" y="303.9199">(enable pairing)</text><polygon fill="#A80036" points="290,333.9727,280,337.9727,290,341.9727,286,337.9727" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="872" y1="337.9727" y2="337.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="296" y="333.2305">pairingCode</text><polygon fill="#A80036" points="861,363.2832,871,367.2832,861,371.2832,865,367.2832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="867" y1="367.2832" y2="367.2832"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="286" y="362.541">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="317" y="362.541">/irma/session/{clientToken}/frontend/status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="607" y="362.541">(start polling)</text><polygon fill="#A80036" points="68.5,392.5938,58.5,396.5938,68.5,400.5938,64.5,396.5938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62.5" x2="278" y1="396.5938" y2="396.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="74.5" y="391.8516">QR</text><polygon fill="#A80036" points="176.5,421.9043,186.5,425.9043,176.5,429.9043,180.5,425.9043" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="57.5" x2="182.5" y1="425.9043" y2="425.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="64.5" y="421.1621">scan QR</text><polygon fill="#A80036" points="267,451.2148,277,455.2148,267,459.2148,271,455.2148" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="188.5" x2="273" y1="455.2148" y2="455.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="195.5" y="450.4727">read QR</text><polygon fill="#A80036" points="861,480.5254,871,484.5254,861,488.5254,865,484.5254" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="188.5" x2="867" y1="484.5254" y2="484.5254"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="195.5" y="479.7832">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="226.5" y="479.7832">/irma/session/{clientToken}</text><polygon fill="#A80036" points="199.5,509.8359,189.5,513.8359,199.5,517.8359,195.5,513.8359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="872" y1="513.8359" y2="513.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="205.5" y="509.0938">pairing method and code</text><polygon fill="#A80036" points="68.5,539.1465,58.5,543.1465,68.5,547.1465,64.5,543.1465" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62.5" x2="187.5" y1="543.1465" y2="543.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="74.5" y="538.4043">pairing code</text><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="873" y1="572.457" y2="572.457"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="831" y1="572.457" y2="585.457"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="872" y1="585.457" y2="585.457"/><polygon fill="#A80036" points="864,581.457,874,585.457,864,589.457,868,585.457" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="721" y="567.7148">change state to PAIRING</text><polygon fill="#A80036" points="290,610.7676,280,614.7676,290,618.7676,286,614.7676" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="872" y1="614.7676" y2="614.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273" x="296" y="610.0254">polling response: state changed to PAIRING</text><polygon fill="#A80036" points="861,640.0781,871,644.0781,861,648.0781,865,644.0781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="188.5" x2="867" y1="644.0781" y2="644.0781"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="195.5" y="639.3359">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="226.5" y="639.3359">/irma/session/{clientToken}/status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="455.5" y="639.3359">(start polling)</text><polygon fill="#A80036" points="68.5,669.3887,58.5,673.3887,68.5,677.3887,64.5,673.3887" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62.5" x2="278" y1="673.3887" y2="673.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="74.5" y="668.6465">pairing code?</text><polygon fill="#A80036" points="267,698.6992,277,702.6992,267,706.6992,271,702.6992" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="57.5" x2="273" y1="702.6992" y2="702.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="64.5" y="697.957">pairing code</text><polygon fill="#A80036" points="861,728.0098,871,732.0098,861,736.0098,865,732.0098" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="867" y1="732.0098" y2="732.0098"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35" x="286" y="727.2676">POST</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="357" x="325" y="727.2676">/irma/session/{clientToken}/frontend/pairingcompleted</text><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="873" y1="761.3203" y2="761.3203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="831" y1="761.3203" y2="774.3203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="872" y1="774.3203" y2="774.3203"/><polygon fill="#A80036" points="864,770.3203,874,774.3203,864,778.3203,868,774.3203" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="692" y="756.5781">change state to CONNECTED</text><polygon fill="#A80036" points="290,799.6309,280,803.6309,290,807.6309,286,803.6309" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="872" y1="803.6309" y2="803.6309"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302" x="296" y="798.8887">polling response: state changed to CONNECTED</text><polygon fill="#A80036" points="199.5,828.9414,189.5,832.9414,199.5,836.9414,195.5,832.9414" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="872" y1="832.9414" y2="832.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302" x="205.5" y="828.1992">polling response: state changed to CONNECTED</text><polygon fill="#A80036" points="861,858.252,871,862.252,861,866.252,865,862.252" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="188.5" x2="867" y1="862.252" y2="862.252"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="195.5" y="857.5098">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="226.5" y="857.5098">/irma/session/{clientToken}/request</text><polygon fill="#A80036" points="199.5,887.5625,189.5,891.5625,199.5,895.5625,195.5,891.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="872" y1="891.5625" y2="891.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="205.5" y="886.8203">session request</text><polygon fill="#A80036" points="68.5,916.873,58.5,920.873,68.5,924.873,64.5,920.873" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62.5" x2="187.5" y1="920.873" y2="920.873"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="74.5" y="916.1309">perform session?</text><polygon fill="#A80036" points="176.5,946.1836,186.5,950.1836,176.5,954.1836,180.5,950.1836" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="57.5" x2="182.5" y1="950.1836" y2="950.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="64.5" y="945.4414">yes</text><polygon fill="#A80036" points="861,975.4941,871,979.4941,861,983.4941,865,979.4941" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="188.5" x2="867" y1="979.4941" y2="979.4941"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35" x="195.5" y="974.752">POST</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="521" x="234.5" y="974.752">/irma/session/{clientToken}/proofs or /irma/session/{clientToken}/commitments</text><polygon fill="#A80036" points="199.5,1004.8047,189.5,1008.8047,199.5,1012.8047,195.5,1008.8047" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="872" y1="1008.8047" y2="1008.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387" x="205.5" y="1004.0625">proofStatus, possibly nextSession, possibly issuer signatures</text><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="873" y1="1038.1152" y2="1038.1152"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="831" y1="1038.1152" y2="1051.1152"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="872" y1="1051.1152" y2="1051.1152"/><polygon fill="#A80036" points="864,1047.1152,874,1051.1152,864,1055.1152,868,1051.1152" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="735" y="1033.373">change state to DONE</text><polygon fill="#A80036" points="290,1076.4258,280,1080.4258,290,1084.4258,286,1080.4258" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="872" y1="1080.4258" y2="1080.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="418" x="296" y="1075.6836">polling response: state changed to DONE (+ possibly nextSession)</text><polygon fill="#A80036" points="520,1105.7363,530,1109.7363,520,1113.7363,524,1109.7363" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="526" y1="1109.7363" y2="1109.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="286" y="1104.9941">done</text><polygon fill="#A80036" points="861,1135.0469,871,1139.0469,861,1143.0469,865,1139.0469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532" x2="867" y1="1139.0469" y2="1139.0469"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="539" y="1134.3047">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="570" y="1134.3047">/session/{requestorToken}/result</text><polygon fill="#A80036" points="543,1164.3574,533,1168.3574,543,1172.3574,539,1168.3574" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="537" x2="872" y1="1168.3574" y2="1168.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="549" y="1163.6152">session result</text><polygon fill="#A80036" points="290,1193.668,280,1197.668,290,1201.668,286,1197.668" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="531" y1="1197.668" y2="1197.668"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="296" y="1192.9258">follow-up action</text><polygon fill="#A80036" points="68.5,1222.9785,58.5,1226.9785,68.5,1230.9785,64.5,1226.9785" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62.5" x2="278" y1="1226.9785" y2="1226.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="74.5" y="1222.2363">follow-up action</text><!--MD5=[1d9018efb61dfb5cbbe33908576b4587]
@startuml session-pairing
skinparam sequence {
backgroundColor #transparent
ActorBorderColor #7A2626
ActorBackgroundColor #transparent
ParticipantBorderColor #7A2626
ParticipantBackgroundColor #004C92
ParticipantFontColor white
} 

actor "IRMA app user" as user
participant "IRMA app" as app
participant frontend as browser
participant "requestor" as requestor
participant "IRMA server" as server


user -> browser: initiate session
browser -> requestor: initiate session
requestor -> server: <font color=#1D5B2A>**POST** /session/</font> (create session)
server <- server: set state to INITIALIZED
server - -> requestor: session pointer + requestor token + frontendAuth 
requestor - -> browser: session pointer (QR) + frontendAuth
browser -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/frontend/options</font> (enable pairing)
return pairingCode
browser -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/frontend/status </font>(start polling)
browser -> user: QR
user -> app: scan QR
app -> browser: read QR
app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}</font>
' if pairing is not enabled, the session request will be returned directly
return pairing method and code
app -> user: pairing code
server <- server: change state to PAIRING
server - -> browser: polling response: state changed to PAIRING
app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/status</font> (start polling)
browser -> user: pairing code?
return pairing code
browser -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/frontend/pairingcompleted</font>
server <- server: change state to CONNECTED
server - -> browser: polling response: state changed to CONNECTED
server - -> app: polling response: state changed to CONNECTED

app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/request</font>
return session request
app -> user: perform session?
return yes

app -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/proofs or /irma/session/{clientToken}/commitments</font>
return proofStatus, possibly nextSession, possibly issuer signatures
server <- server: change state to DONE

server - -> browser: polling response: state changed to DONE (+ possibly nextSession)
browser -> requestor: done
requestor -> server: <font color=#1D5B2A>**GET** /session/{requestorToken}/result
server -> requestor: session result
requestor - -> browser: follow-up action

browser -> user: follow-up action

@enduml

@startuml session-pairing
skinparam sequence {
backgroundColor #transparent
ActorBorderColor #7A2626
ActorBackgroundColor #transparent
ParticipantBorderColor #7A2626
ParticipantBackgroundColor #004C92
ParticipantFontColor white
} 

actor "IRMA app user" as user
participant "IRMA app" as app
participant frontend as browser
participant "requestor" as requestor
participant "IRMA server" as server


user -> browser: initiate session
browser -> requestor: initiate session
requestor -> server: <font color=#1D5B2A>**POST** /session/</font> (create session)
server <- server: set state to INITIALIZED
server - -> requestor: session pointer + requestor token + frontendAuth 
requestor - -> browser: session pointer (QR) + frontendAuth
browser -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/frontend/options</font> (enable pairing)
return pairingCode
browser -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/frontend/status </font>(start polling)
browser -> user: QR
user -> app: scan QR
app -> browser: read QR
app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}</font>
return pairing method and code
app -> user: pairing code
server <- server: change state to PAIRING
server - -> browser: polling response: state changed to PAIRING
app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/status</font> (start polling)
browser -> user: pairing code?
return pairing code
browser -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/frontend/pairingcompleted</font>
server <- server: change state to CONNECTED
server - -> browser: polling response: state changed to CONNECTED
server - -> app: polling response: state changed to CONNECTED

app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/request</font>
return session request
app -> user: perform session?
return yes

app -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/proofs or /irma/session/{clientToken}/commitments</font>
return proofStatus, possibly nextSession, possibly issuer signatures
server <- server: change state to DONE

server - -> browser: polling response: state changed to DONE (+ possibly nextSession)
browser -> requestor: done
requestor -> server: <font color=#1D5B2A>**GET** /session/{requestorToken}/result
server -> requestor: session result
requestor - -> browser: follow-up action

browser -> user: follow-up action

@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: NL
--></g></svg>