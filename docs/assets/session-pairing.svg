<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1312px" preserveAspectRatio="none" style="width:931px;height:1312px;background:#FFFFFF;" version="1.1" viewBox="0 0 931 1312" width="931px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="57" x2="57" y1="81.2969" y2="1231.2109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="191.5" x2="191.5" y1="81.2969" y2="1231.2109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="276.5" x2="276.5" y1="81.2969" y2="1231.2109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="533" x2="533" y1="81.2969" y2="1231.2109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="877.5" x2="877.5" y1="81.2969" y2="1231.2109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="5" y="77.9951">IRMA app user</text><ellipse cx="57.5" cy="13.5" rx="8" ry="8" style="stroke:#7A2626;stroke-width:0.5;fill:none;"/><path d="M57.5,21.5 L57.5,48.5 M44.5,29.5 L70.5,29.5 M57.5,48.5 L44.5,63.5 M57.5,48.5 L70.5,63.5 " fill="none" style="stroke:#7A2626;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="5" y="1243.2061">IRMA app user</text><ellipse cx="57.5" cy="1255.0078" rx="8" ry="8" style="stroke:#7A2626;stroke-width:0.5;fill:none;"/><path d="M57.5,1263.0078 L57.5,1290.0078 M44.5,1271.0078 L70.5,1271.0078 M57.5,1290.0078 L44.5,1305.0078 M57.5,1290.0078 L70.5,1305.0078 " fill="none" style="stroke:#7A2626;stroke-width:0.5;"/><rect fill="#004C92" height="30.2969" rx="2.5" ry="2.5" style="stroke:#7A2626;stroke-width:0.5;" width="78" x="152.5" y="50"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="159.5" y="69.9951">IRMA app</text><rect fill="#004C92" height="30.2969" rx="2.5" ry="2.5" style="stroke:#7A2626;stroke-width:0.5;" width="78" x="152.5" y="1230.2109"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="159.5" y="1250.2061">IRMA app</text><rect fill="#004C92" height="30.2969" rx="2.5" ry="2.5" style="stroke:#7A2626;stroke-width:0.5;" width="73" x="240.5" y="50"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="247.5" y="69.9951">frontend</text><rect fill="#004C92" height="30.2969" rx="2.5" ry="2.5" style="stroke:#7A2626;stroke-width:0.5;" width="73" x="240.5" y="1230.2109"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="247.5" y="1250.2061">frontend</text><rect fill="#004C92" height="30.2969" rx="2.5" ry="2.5" style="stroke:#7A2626;stroke-width:0.5;" width="82" x="492" y="50"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="499" y="69.9951">requestor</text><rect fill="#004C92" height="30.2969" rx="2.5" ry="2.5" style="stroke:#7A2626;stroke-width:0.5;" width="82" x="492" y="1230.2109"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="499" y="1250.2061">requestor</text><rect fill="#004C92" height="30.2969" rx="2.5" ry="2.5" style="stroke:#7A2626;stroke-width:0.5;" width="95" x="830.5" y="50"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="837.5" y="69.9951">IRMA server</text><rect fill="#004C92" height="30.2969" rx="2.5" ry="2.5" style="stroke:#7A2626;stroke-width:0.5;" width="95" x="830.5" y="1230.2109"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="837.5" y="1250.2061">IRMA server</text><polygon fill="#181818" points="265,108.4297,275,112.4297,265,116.4297,269,112.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="57.5" x2="271" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="64.5" y="107.3638">initiate session</text><polygon fill="#181818" points="521,137.5625,531,141.5625,521,145.5625,525,141.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="277" x2="527" y1="141.5625" y2="141.5625"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38" x="284" y="136.4966">POST</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="326" y="136.4966">/session/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="386" y="136.4966">(create session)</text><polygon fill="#181818" points="866,166.6953,876,170.6953,866,174.6953,870,170.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="533" x2="872" y1="170.6953" y2="170.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="540" y="165.6294">initiate session</text><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="878" y1="199.8281" y2="199.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="836" y1="199.8281" y2="212.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="877" y1="212.8281" y2="212.8281"/><polygon fill="#181818" points="869,208.8281,879,212.8281,869,216.8281,873,212.8281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="727" y="194.7622">set state to INITIALIZED</text><polygon fill="#181818" points="544,237.9609,534,241.9609,544,245.9609,540,241.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="538" x2="877" y1="241.9609" y2="241.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="321" x="550" y="236.895">session pointer + requestor token + frontendAuth</text><polygon fill="#181818" points="288,267.0938,278,271.0938,288,275.0938,284,271.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="282" x2="532" y1="271.0938" y2="271.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232" x="294" y="266.0278">session pointer (QR) + frontendAuth</text><polygon fill="#181818" points="866,296.2266,876,300.2266,866,304.2266,870,300.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="277" x2="872" y1="300.2266" y2="300.2266"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38" x="284" y="295.1606">POST</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="326" y="295.1606">/irma/session/{clientToken}/frontend/options</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="616" y="295.1606">(enable pairing)</text><polygon fill="#181818" points="288,325.3594,278,329.3594,288,333.3594,284,329.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="282" x2="877" y1="329.3594" y2="329.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="294" y="324.2935">pairingCode</text><polygon fill="#181818" points="866,354.4922,876,358.4922,866,362.4922,870,358.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="277" x2="872" y1="358.4922" y2="358.4922"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="284" y="353.4263">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279" x="316" y="353.4263">/irma/session/{clientToken}/frontend/status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="599" y="353.4263">(start polling)</text><polygon fill="#181818" points="68.5,383.625,58.5,387.625,68.5,391.625,64.5,387.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="62.5" x2="276" y1="387.625" y2="387.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="74.5" y="382.5591">QR</text><polygon fill="#181818" points="179.5,412.7578,189.5,416.7578,179.5,420.7578,183.5,416.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="57.5" x2="185.5" y1="416.7578" y2="416.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="64.5" y="411.6919">scan QR</text><polygon fill="#181818" points="265,441.8906,275,445.8906,265,449.8906,269,445.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191.5" x2="271" y1="445.8906" y2="445.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="198.5" y="440.8247">read QR</text><polygon fill="#181818" points="866,471.0234,876,475.0234,866,479.0234,870,475.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191.5" x2="872" y1="475.0234" y2="475.0234"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="198.5" y="469.9575">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="230.5" y="469.9575">/irma/session/{clientToken}</text><polygon fill="#181818" points="202.5,500.1563,192.5,504.1563,202.5,508.1563,198.5,504.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="196.5" x2="877" y1="504.1563" y2="504.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="208.5" y="499.0903">pairing method and code</text><polygon fill="#181818" points="68.5,529.2891,58.5,533.2891,68.5,537.2891,64.5,533.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="62.5" x2="190.5" y1="533.2891" y2="533.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="74.5" y="528.2231">pairing code</text><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="878" y1="562.4219" y2="562.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="836" y1="562.4219" y2="575.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="877" y1="575.4219" y2="575.4219"/><polygon fill="#181818" points="869,571.4219,879,575.4219,869,579.4219,873,575.4219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="722" y="557.356">change state to PAIRING</text><polygon fill="#181818" points="288,600.5547,278,604.5547,288,608.5547,284,604.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="282" x2="877" y1="604.5547" y2="604.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276" x="294" y="599.4888">polling response: state changed to PAIRING</text><polygon fill="#181818" points="866,629.6875,876,633.6875,866,637.6875,870,633.6875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191.5" x2="872" y1="633.6875" y2="633.6875"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="198.5" y="628.6216">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="230.5" y="628.6216">/irma/session/{clientToken}/status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="455.5" y="628.6216">(start polling)</text><polygon fill="#181818" points="68.5,658.8203,58.5,662.8203,68.5,666.8203,64.5,662.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="62.5" x2="276" y1="662.8203" y2="662.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="74.5" y="657.7544">pairing code?</text><polygon fill="#181818" points="265,687.9531,275,691.9531,265,695.9531,269,691.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="57.5" x2="271" y1="691.9531" y2="691.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="64.5" y="686.8872">pairing code</text><polygon fill="#181818" points="866,717.0859,876,721.0859,866,725.0859,870,721.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="277" x2="872" y1="721.0859" y2="721.0859"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38" x="284" y="716.02">POST</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="350" x="326" y="716.02">/irma/session/{clientToken}/frontend/pairingcompleted</text><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="878" y1="750.2188" y2="750.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="836" y1="750.2188" y2="763.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="877" y1="763.2188" y2="763.2188"/><polygon fill="#181818" points="869,759.2188,879,763.2188,869,767.2188,873,763.2188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="692" y="745.1528">change state to CONNECTED</text><polygon fill="#181818" points="288,788.3516,278,792.3516,288,796.3516,284,792.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="282" x2="877" y1="792.3516" y2="792.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="294" y="787.2856">polling response: state changed to CONNECTED</text><polygon fill="#181818" points="202.5,817.4844,192.5,821.4844,202.5,825.4844,198.5,821.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="196.5" x2="877" y1="821.4844" y2="821.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="208.5" y="816.4185">polling response: state changed to CONNECTED</text><polygon fill="#181818" points="866,846.6172,876,850.6172,866,854.6172,870,850.6172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191.5" x2="872" y1="850.6172" y2="850.6172"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="198.5" y="845.5513">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="230.5" y="845.5513">/irma/session/{clientToken}/request</text><polygon fill="#181818" points="202.5,875.75,192.5,879.75,202.5,883.75,198.5,879.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="196.5" x2="877" y1="879.75" y2="879.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="208.5" y="874.6841">session request</text><polygon fill="#181818" points="68.5,904.8828,58.5,908.8828,68.5,912.8828,64.5,908.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="62.5" x2="190.5" y1="908.8828" y2="908.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="74.5" y="903.8169">perform session?</text><polygon fill="#181818" points="179.5,934.0156,189.5,938.0156,179.5,942.0156,183.5,938.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="57.5" x2="185.5" y1="938.0156" y2="938.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="64.5" y="932.9497">yes</text><polygon fill="#181818" points="866,963.1484,876,967.1484,866,971.1484,870,967.1484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191.5" x2="872" y1="967.1484" y2="967.1484"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38" x="198.5" y="962.0825">POST</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="513" x="240.5" y="962.0825">/irma/session/{clientToken}/proofs or /irma/session/{clientToken}/commitments</text><polygon fill="#181818" points="202.5,992.2813,192.5,996.2813,202.5,1000.2813,198.5,996.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="196.5" x2="877" y1="996.2813" y2="996.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388" x="208.5" y="991.2153">proofStatus, possibly nextSession, possibly issuer signatures</text><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="878" y1="1025.4141" y2="1025.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="836" y1="1025.4141" y2="1038.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="836" x2="877" y1="1038.4141" y2="1038.4141"/><polygon fill="#181818" points="869,1034.4141,879,1038.4141,869,1042.4141,873,1038.4141" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="735" y="1020.3481">change state to DONE</text><polygon fill="#181818" points="288,1063.5469,278,1067.5469,288,1071.5469,284,1067.5469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="282" x2="877" y1="1067.5469" y2="1067.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="425" x="294" y="1062.481">polling response: state changed to DONE (+ possibly nextSession)</text><polygon fill="#181818" points="521,1092.6797,531,1096.6797,521,1100.6797,525,1096.6797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="277" x2="527" y1="1096.6797" y2="1096.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="284" y="1091.6138">done</text><polygon fill="#181818" points="866,1121.8125,876,1125.8125,866,1129.8125,870,1125.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="533" x2="872" y1="1125.8125" y2="1125.8125"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="540" y="1120.7466">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="572" y="1120.7466">/session/{requestorToken}/result</text><polygon fill="#181818" points="544,1150.9453,534,1154.9453,544,1158.9453,540,1154.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="538" x2="877" y1="1154.9453" y2="1154.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="550" y="1149.8794">session result</text><polygon fill="#181818" points="288,1180.0781,278,1184.0781,288,1188.0781,284,1184.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="282" x2="532" y1="1184.0781" y2="1184.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="294" y="1179.0122">follow-up action</text><polygon fill="#181818" points="68.5,1209.2109,58.5,1213.2109,68.5,1217.2109,64.5,1213.2109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="62.5" x2="276" y1="1213.2109" y2="1213.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="74.5" y="1208.145">follow-up action</text><!--MD5=[0f28c7c49fb83b8ccf10988967de668d]
@startuml session-pairing
skinparam sequence {
backgroundColor #transparent
ActorBorderColor #7A2626
ActorBackgroundColor #transparent
ParticipantBorderColor #7A2626
ParticipantBackgroundColor #004C92
ParticipantFontColor white
} 

actor "IRMA app user" as user
participant "IRMA app" as app
participant frontend as browser
participant "requestor" as requestor
participant "IRMA server" as server


user -> browser: initiate session
browser -> requestor: <font color=#1D5B2A>**POST** /session/</font> (create session)
requestor -> server: initiate session
server <- server: set state to INITIALIZED
server - -> requestor: session pointer + requestor token + frontendAuth 
requestor - -> browser: session pointer (QR) + frontendAuth
browser -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/frontend/options</font> (enable pairing)
return pairingCode
browser -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/frontend/status </font>(start polling)
browser -> user: QR
user -> app: scan QR
app -> browser: read QR
app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}</font>
' if pairing is not enabled, the session request will be returned directly
return pairing method and code
app -> user: pairing code
server <- server: change state to PAIRING
server - -> browser: polling response: state changed to PAIRING
app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/status</font> (start polling)
browser -> user: pairing code?
return pairing code
browser -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/frontend/pairingcompleted</font>
server <- server: change state to CONNECTED
server - -> browser: polling response: state changed to CONNECTED
server - -> app: polling response: state changed to CONNECTED

app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/request</font>
return session request
app -> user: perform session?
return yes

app -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/proofs or /irma/session/{clientToken}/commitments</font>
return proofStatus, possibly nextSession, possibly issuer signatures
server <- server: change state to DONE

server - -> browser: polling response: state changed to DONE (+ possibly nextSession)
browser -> requestor: done
requestor -> server: <font color=#1D5B2A>**GET** /session/{requestorToken}/result
server -> requestor: session result
requestor - -> browser: follow-up action

browser -> user: follow-up action

@enduml

@startuml session-pairing
skinparam sequence {
backgroundColor #transparent
ActorBorderColor #7A2626
ActorBackgroundColor #transparent
ParticipantBorderColor #7A2626
ParticipantBackgroundColor #004C92
ParticipantFontColor white
} 

actor "IRMA app user" as user
participant "IRMA app" as app
participant frontend as browser
participant "requestor" as requestor
participant "IRMA server" as server


user -> browser: initiate session
browser -> requestor: <font color=#1D5B2A>**POST** /session/</font> (create session)
requestor -> server: initiate session
server <- server: set state to INITIALIZED
server - -> requestor: session pointer + requestor token + frontendAuth 
requestor - -> browser: session pointer (QR) + frontendAuth
browser -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/frontend/options</font> (enable pairing)
return pairingCode
browser -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/frontend/status </font>(start polling)
browser -> user: QR
user -> app: scan QR
app -> browser: read QR
app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}</font>
return pairing method and code
app -> user: pairing code
server <- server: change state to PAIRING
server - -> browser: polling response: state changed to PAIRING
app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/status</font> (start polling)
browser -> user: pairing code?
return pairing code
browser -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/frontend/pairingcompleted</font>
server <- server: change state to CONNECTED
server - -> browser: polling response: state changed to CONNECTED
server - -> app: polling response: state changed to CONNECTED

app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/request</font>
return session request
app -> user: perform session?
return yes

app -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/proofs or /irma/session/{clientToken}/commitments</font>
return proofStatus, possibly nextSession, possibly issuer signatures
server <- server: change state to DONE

server - -> browser: polling response: state changed to DONE (+ possibly nextSession)
browser -> requestor: done
requestor -> server: <font color=#1D5B2A>**GET** /session/{requestorToken}/result
server -> requestor: session result
requestor - -> browser: follow-up action

browser -> user: follow-up action

@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>