<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="964px" preserveAspectRatio="none" style="width:932px;height:964px;background:#FFFFFF;" version="1.1" viewBox="0 0 932 964" width="932px" zoomAndPan="magnify"><defs><filter height="300%" id="f1kj8ucpomypwz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="57" x2="57" y1="88.4883" y2="880.252"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="188" x2="188" y1="88.4883" y2="880.252"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="279" x2="279" y1="88.4883" y2="880.252"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="531.5" x2="531.5" y1="88.4883" y2="880.252"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="872.5" x2="872.5" y1="88.4883" y2="880.252"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="5" y="85.5352">Yivi app user</text><ellipse cx="57.5" cy="15" filter="url(#f1kj8ucpomypwz)" rx="8" ry="8" style="stroke:#7A2626;stroke-width:2.0;fill:none;"/><path d="M57.5,23 L57.5,50 M44.5,31 L70.5,31 M57.5,50 L44.5,65 M57.5,50 L70.5,65 " fill="none" filter="url(#f1kj8ucpomypwz)" style="stroke:#7A2626;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="5" y="892.7871">Yivi app user</text><ellipse cx="57.5" cy="905.7402" filter="url(#f1kj8ucpomypwz)" rx="8" ry="8" style="stroke:#7A2626;stroke-width:2.0;fill:none;"/><path d="M57.5,913.7402 L57.5,940.7402 M44.5,921.7402 L70.5,921.7402 M57.5,940.7402 L44.5,955.7402 M57.5,940.7402 L70.5,955.7402 " fill="none" filter="url(#f1kj8ucpomypwz)" style="stroke:#7A2626;stroke-width:2.0;"/><rect fill="#004C92" filter="url(#f1kj8ucpomypwz)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="79" x="147" y="53"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="154" y="73.5352">Yivi app</text><rect fill="#004C92" filter="url(#f1kj8ucpomypwz)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="79" x="147" y="879.252"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="154" y="899.7871">Yivi app</text><rect fill="#004C92" filter="url(#f1kj8ucpomypwz)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="74" x="240" y="53"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="247" y="73.5352">frontend</text><rect fill="#004C92" filter="url(#f1kj8ucpomypwz)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="74" x="240" y="879.252"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="247" y="899.7871">frontend</text><rect fill="#004C92" filter="url(#f1kj8ucpomypwz)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="81" x="489.5" y="53"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="496.5" y="73.5352">requestor</text><rect fill="#004C92" filter="url(#f1kj8ucpomypwz)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="81" x="489.5" y="879.252"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="496.5" y="899.7871">requestor</text><rect fill="#004C92" filter="url(#f1kj8ucpomypwz)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="95" x="823.5" y="53"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="830.5" y="73.5352">IRMA server</text><rect fill="#004C92" filter="url(#f1kj8ucpomypwz)" height="30.4883" style="stroke:#7A2626;stroke-width:1.5;" width="95" x="823.5" y="879.252"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="830.5" y="899.7871">IRMA server</text><polygon fill="#A80036" points="267,115.7988,277,119.7988,267,123.7988,271,119.7988" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="57.5" x2="273" y1="119.7988" y2="119.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="64.5" y="115.0566">initiate session</text><polygon fill="#A80036" points="520,145.1094,530,149.1094,520,153.1094,524,149.1094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="526" y1="149.1094" y2="149.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="286" y="144.3672">initiate session</text><polygon fill="#A80036" points="861,174.4199,871,178.4199,861,182.4199,865,178.4199" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532" x2="867" y1="178.4199" y2="178.4199"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35" x="539" y="173.6777">POST</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="578" y="173.6777">/session/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="644" y="173.6777">(create session)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="873" y1="207.7305" y2="207.7305"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="831" y1="207.7305" y2="220.7305"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="872" y1="220.7305" y2="220.7305"/><polygon fill="#A80036" points="864,216.7305,874,220.7305,864,224.7305,868,220.7305" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="723" y="202.9883">set state to INITIALIZED</text><polygon fill="#A80036" points="543,246.041,533,250.041,543,254.041,539,250.041" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="537" x2="872" y1="250.041" y2="250.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="317" x="549" y="245.2988">session pointer + requestor token + frontendAuth</text><polygon fill="#A80036" points="290,275.3516,280,279.3516,290,283.3516,286,279.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="531" y1="279.3516" y2="279.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="296" y="274.6094">session pointer (QR) + frontendAuth</text><polygon fill="#A80036" points="861,304.6621,871,308.6621,861,312.6621,865,308.6621" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="867" y1="308.6621" y2="308.6621"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="286" y="303.9199">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="317" y="303.9199">/irma/session/{clientToken}/frontend/status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="607" y="303.9199">(start polling)</text><polygon fill="#A80036" points="68.5,333.9727,58.5,337.9727,68.5,341.9727,64.5,337.9727" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62.5" x2="278" y1="337.9727" y2="337.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="74.5" y="333.2305">QR</text><polygon fill="#A80036" points="176.5,363.2832,186.5,367.2832,176.5,371.2832,180.5,367.2832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="57.5" x2="182.5" y1="367.2832" y2="367.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="64.5" y="362.541">scan QR</text><polygon fill="#A80036" points="267,392.5938,277,396.5938,267,400.5938,271,396.5938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="188.5" x2="273" y1="396.5938" y2="396.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="195.5" y="391.8516">read QR</text><polygon fill="#A80036" points="861,421.9043,871,425.9043,861,429.9043,865,425.9043" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="188.5" x2="867" y1="425.9043" y2="425.9043"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="195.5" y="421.1621">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="226.5" y="421.1621">/irma/session/{clientToken}</text><polygon fill="#A80036" points="199.5,451.2148,189.5,455.2148,199.5,459.2148,195.5,455.2148" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="872" y1="455.2148" y2="455.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="205.5" y="450.4727">session request</text><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="873" y1="484.5254" y2="484.5254"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="831" y1="484.5254" y2="497.5254"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="872" y1="497.5254" y2="497.5254"/><polygon fill="#A80036" points="864,493.5254,874,497.5254,864,501.5254,868,497.5254" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="692" y="479.7832">change state to CONNECTED</text><polygon fill="#A80036" points="290,522.8359,280,526.8359,290,530.8359,286,526.8359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="872" y1="526.8359" y2="526.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302" x="296" y="522.0938">polling response: state changed to CONNECTED</text><polygon fill="#A80036" points="68.5,552.1465,58.5,556.1465,68.5,560.1465,64.5,556.1465" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62.5" x2="187.5" y1="556.1465" y2="556.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="74.5" y="551.4043">perform session?</text><polygon fill="#A80036" points="176.5,581.457,186.5,585.457,176.5,589.457,180.5,585.457" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="57.5" x2="182.5" y1="585.457" y2="585.457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="64.5" y="580.7148">yes</text><polygon fill="#A80036" points="861,610.7676,871,614.7676,861,618.7676,865,614.7676" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="188.5" x2="867" y1="614.7676" y2="614.7676"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35" x="195.5" y="610.0254">POST</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="521" x="234.5" y="610.0254">/irma/session/{clientToken}/proofs or /irma/session/{clientToken}/commitments</text><polygon fill="#A80036" points="199.5,640.0781,189.5,644.0781,199.5,648.0781,195.5,644.0781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="193.5" x2="872" y1="644.0781" y2="644.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387" x="205.5" y="639.3359">proofStatus, possibly nextSession, possibly issuer signatures</text><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="873" y1="673.3887" y2="673.3887"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="831" y1="673.3887" y2="686.3887"/><line style="stroke:#A80036;stroke-width:1.0;" x1="831" x2="872" y1="686.3887" y2="686.3887"/><polygon fill="#A80036" points="864,682.3887,874,686.3887,864,690.3887,868,686.3887" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="735" y="668.6465">change state to DONE</text><polygon fill="#A80036" points="290,711.6992,280,715.6992,290,719.6992,286,715.6992" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="872" y1="715.6992" y2="715.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="418" x="296" y="710.957">polling response: state changed to DONE (+ possibly nextSession)</text><polygon fill="#A80036" points="520,741.0098,530,745.0098,520,749.0098,524,745.0098" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="526" y1="745.0098" y2="745.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="286" y="740.2676">done</text><polygon fill="#A80036" points="861,770.3203,871,774.3203,861,778.3203,865,774.3203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="532" x2="867" y1="774.3203" y2="774.3203"/><text fill="#1D5B2A" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="539" y="769.5781">GET</text><text fill="#1D5B2A" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="570" y="769.5781">/session/{requestorToken}/result</text><polygon fill="#A80036" points="543,799.6309,533,803.6309,543,807.6309,539,803.6309" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="537" x2="872" y1="803.6309" y2="803.6309"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="549" y="798.8887">session result</text><polygon fill="#A80036" points="290,828.9414,280,832.9414,290,836.9414,286,832.9414" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="531" y1="832.9414" y2="832.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="296" y="828.1992">follow-up action</text><polygon fill="#A80036" points="68.5,858.252,58.5,862.252,68.5,866.252,64.5,862.252" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62.5" x2="278" y1="862.252" y2="862.252"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="74.5" y="857.5098">follow-up action</text><!--MD5=[5264a946837b936ab2b90cedfbbfe9f5]
@startuml session-no-pairing
skinparam sequence {
backgroundColor #transparent
ActorBorderColor #7A2626
ActorBackgroundColor #transparent
ParticipantBorderColor #7A2626
ParticipantBackgroundColor #004C92
ParticipantFontColor white
} 

actor "Yivi app user" as user
participant "Yivi app" as app
participant frontend as browser
participant "requestor" as requestor
participant "IRMA server" as server

user -> browser: initiate session
browser -> requestor: initiate session
requestor -> server: <font color=#1D5B2A>**POST** /session/</font> (create session)
server <- server: set state to INITIALIZED   
server - -> requestor: session pointer + requestor token + frontendAuth 
requestor - -> browser: session pointer (QR) + frontendAuth
browser -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}/frontend/status </font>(start polling)
browser -> user: QR
user -> app: scan QR
app -> browser: read QR
app -> server: <font color=#1D5B2A>**GET** /irma/session/{clientToken}</font>
return session request
server <- server: change state to CONNECTED
server - -> browser: polling response: state changed to CONNECTED

app -> user: perform session?
return yes

app -> server: <font color=#1D5B2A>**POST** /irma/session/{clientToken}/proofs or /irma/session/{clientToken}/commitments</font>
return proofStatus, possibly nextSession, possibly issuer signatures
server <- server: change state to DONE

server - -> browser: polling response: state changed to DONE (+ possibly nextSession)
browser -> requestor: done
requestor -> server: <font color=#1D5B2A>**GET** /session/{requestorToken}/result
server -> requestor: session result
requestor - -> browser: follow-up action

browser -> user: follow-up action

@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: NL
--></g></svg>